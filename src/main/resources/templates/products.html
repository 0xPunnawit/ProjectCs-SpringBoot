<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{base::Layout(~{::section})}">

<head>
  <meta charset="UTF-8">
  <title>Products</title>

</head>

<body>

<!-- ‡πÇ‡∏´‡∏•‡∏î JavaScript -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/static/js/search.js"></script>

<section>

  <div class="container-fluid bg-primary p-5 mt-5">
    <div class="row">
      <div class="col-md-8 offset-md-2">

        <!-- üîç ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
        <form id="searchForm" action="/products-list" method="GET">
          <div class="input-group position-relative">
            <input type="text" class="form-control" id="searchInput" name="query" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..." autocomplete="off">
            <button type="submit" class="btn btn-light text-dark ms-3 col-md-2" id="searchBtn">Search</button>
          </div>
          <!-- üî• ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå Auto-Suggest -->
          <div id="suggestions" class="list-group position-absolute w-100 bg-white shadow-lg mt-1" style="z-index: 1000; display: none;"></div>
        </form>

      </div>
    </div>
  </div>
  <br>

  <div class="container-fluid mt-3">
    <div class="row">

      <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ -->
      <!-- üî• ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
      <div class="col-md-2">
        <div class="list-group border rounded shadow-sm p-2">
          <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
          <button type="button" class="list-group-item list-group-item-action bg-dark text-white active fw-bold text-center" aria-current="true">
            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
          </button>

          <form action="/products-list" method="GET" class="mt-2">
            <!-- ‡∏õ‡∏∏‡πà‡∏° "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" -->
            <button type="submit" name="status" value="ALL" class="list-group-item list-group-item-action text-white bg-success fw-bold mb-2 rounded">
              ALL
            </button>

            <!-- ‡∏õ‡∏∏‡πà‡∏° "OPEN_SALE" -->
            <button type="submit" name="status" value="OPEN_SALE" class="list-group-item list-group-item-action text-white bg-primary fw-bold mb-2 rounded">
              OPEN_SALE
            </button>

            <!-- ‡∏õ‡∏∏‡πà‡∏° "CLOSE_SALE" -->
            <button type="submit" name="status" value="CLOSE_SALE" class="list-group-item list-group-item-action text-dark bg-warning fw-bold mb-2 rounded">
              CLOSE_SALE
            </button>

            <!-- ‡∏õ‡∏∏‡πà‡∏° "STOP_SALE" -->
            <button type="submit" name="status" value="STOP_SALE" class="list-group-item list-group-item-action text-white bg-danger fw-bold mb-2 rounded">
              STOP_SALE
            </button>
          </form>
        </div>
      </div>



      <!-- ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ -->
      <div class="col-md-10">
        <div class="card shadow-sm">
          <div class="card-body">
            <p class="fs-3 text-center fw-bold">Products</p>

            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
            <div th:if="${successMessage}" class="alert alert-success text-center fw-bold mt-3" role="alert" th:text="${successMessage}"></div>
            <div th:if="${errorMessage}" class="alert alert-danger text-center fw-bold mt-3" role="alert" th:text="${errorMessage}"></div>
            <div th:if="${infoMessage}" class="alert alert-info text-center fw-bold mt-3" role="alert" th:text="${infoMessage}"></div>

            <div class="row" id="productList">
              <!-- Loop ‡∏ú‡πà‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
              <div class="col-md-4 mb-3" th:each="product : ${products}">
                <div class="card product-card">
                  <div class="card-body">
                    <h5 class="card-title">
                      <strong>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: </strong><span th:text="${product.name}"></span>
                    </h5>
                    <p class="card-text">
                      <strong>‡∏£‡∏≤‡∏Ñ‡∏≤: </strong><span th:text="${product.productsPrice}"></span>
                    </p>

                    <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:
                      <span th:switch="${#strings.trim(product.status)}">
                        <span th:case="'OPEN_SALE'" class="badge bg-primary">OPEN_SALE</span>
                        <span th:case="'CLOSE_SALE'" class="badge bg-warning">CLOSE_SALE</span>
                        <span th:case="'STOP_SALE'" class="badge bg-danger">STOP_SALE</span>
                        <span th:case="*" class="badge bg-secondary">Unknown</span>
                      </span>
                    </p>


                    <div class="d-flex justify-content-end gap-2 position-relative">
                      <!-- ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ä‡πà‡∏≤ -->
                      <p class="rental-days">
                        <strong>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ä‡πà‡∏≤: </strong><span th:text="${product.rentalDays} + ' ‡∏ß‡∏±‡∏ô'"></span>
                      </p>

                      <!-- ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
                      <a th:href="@{/view-product/{id}(id=${product.productId})}" class="btn btn-info">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</a>

                      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
                      <form th:if="${userInfo != null}" th:action="@{/purchase}" method="POST"
                            onsubmit="return confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?');">
                        <input type="hidden" name="productId" th:value="${product.productId}">
                        <input type="hidden" name="userId" th:value="${userInfo.userId}">
                        <button type="submit" class="btn btn-success"
                                th:disabled="${#strings.trim(product.status) != 'OPEN_SALE'}">
                          ‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                        </button>
                      </form>

                      <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->
                      <p th:if="${userInfo == null}" class="text-danger">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ</p>
                    </div>




                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <br>
</section>


</body>

</html>
